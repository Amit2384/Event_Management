{% extends 'base.html' %}

{% block title %}Send Notification - {{ event.title }} - EventHub{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <!-- Header -->
    <div class="mb-6">
        <a href="{% url 'events:event_detail' event.slug %}" class="text-blue-600 hover:text-blue-800 mb-2 inline-block">
            <i class="fas fa-arrow-left mr-2"></i>Back to Event
        </a>
        <h1 class="text-4xl font-bold text-gray-800 mb-2">
            <i class="fas fa-bell mr-2"></i>Send Notification
        </h1>
        <p class="text-gray-600">{{ event.title }}</p>
    </div>
    
    <!-- Info Card -->
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
        <div class="flex items-start">
            <i class="fas fa-info-circle text-blue-600 text-2xl mr-4"></i>
            <div>
                <h3 class="text-lg font-bold text-blue-900 mb-2">Notification Information</h3>
                <p class="text-blue-800 text-sm mb-2">
                    This notification will be sent to all attendees who have registered for this event.
                </p>
                <p class="text-blue-800 text-sm font-semibold">
                    <i class="fas fa-users mr-2"></i>Total Recipients: 
                    <span class="bg-blue-200 px-2 py-1 rounded">
                        {{ event.rsvps.count }} attendees
                    </span>
                </p>
            </div>
        </div>
    </div>
    
    <!-- Notification Form -->
    <div class="bg-white rounded-lg shadow-lg p-8">
        <form method="post" class="space-y-6">
            {% csrf_token %}
            
            <!-- Subject -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-heading mr-1"></i>Subject *
                </label>
                <input type="text" 
                       name="subject" 
                       required
                       placeholder="Enter notification subject"
                       class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <p class="text-gray-500 text-xs mt-1">
                    This will appear as the email subject line
                </p>
            </div>
            
            <!-- Message -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-comment-alt mr-1"></i>Message *
                </label>
                <textarea name="message" 
                          rows="8" 
                          required
                          placeholder="Enter your message here..."
                          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                <p class="text-gray-500 text-xs mt-1">
                    Write a clear and informative message for your attendees
                </p>
            </div>
            
            <!-- Message Templates -->
            <div class="bg-gray-50 rounded-lg p-4">
                <p class="text-sm font-semibold text-gray-700 mb-2">
                    <i class="fas fa-file-alt mr-1"></i>Quick Templates:
                </p>
                <div class="space-y-2">
                    <button type="button" onclick="useTemplate('reminder')" class="text-sm text-blue-600 hover:text-blue-800 block">
                        • Event Reminder Template
                    </button>
                    <button type="button" onclick="useTemplate('update')" class="text-sm text-blue-600 hover:text-blue-800 block">
                        • Event Update Template
                    </button>
                    <button type="button" onclick="useTemplate('thankyou')" class="text-sm text-blue-600 hover:text-blue-800 block">
                        • Thank You Template
                    </button>
                </div>
            </div>
            
            <!-- Preview -->
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <p class="text-sm font-semibold text-gray-700 mb-2">
                    <i class="fas fa-eye mr-1"></i>Variables you can use:
                </p>
                <div class="grid grid-cols-2 gap-2 text-xs text-gray-600">
                    <code class="bg-white px-2 py-1 rounded">{event_title}</code>
                    <code class="bg-white px-2 py-1 rounded">{event_date}</code>
                    <code class="bg-white px-2 py-1 rounded">{venue_name}</code>
                    <code class="bg-white px-2 py-1 rounded">{attendee_name}</code>
                </div>
            </div>
            
            <!-- Submit Buttons -->
            <div class="flex justify-end space-x-4 pt-6">
                <a href="{% url 'events:event_detail' event.slug %}" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition">
                    <i class="fas fa-times mr-2"></i>Cancel
                </a>
                <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                    <i class="fas fa-paper-plane mr-2"></i>Send Notification
                </button>
            </div>
        </form>
    </div>
</div>

<script>
function useTemplate(type) {
    const subjectInput = document.querySelector('input[name="subject"]');
    const messageInput = document.querySelector('textarea[name="message"]');
    
    if (type === 'reminder') {
        subjectInput.value = 'Reminder: {{ event.title }} is Tomorrow!';
        messageInput.value = 'Dear {attendee_name},\n\nThis is a friendly reminder that {event_title} is happening tomorrow!\n\nEvent Details:\n- Date: {event_date}\n- Venue: {venue_name}\n\nPlease bring your ticket and arrive 15 minutes early for check-in.\n\nWe look forward to seeing you there!\n\nBest regards,\nThe Event Team';
    } else if (type === 'update') {
        subjectInput.value = 'Important Update: {{ event.title }}';
        messageInput.value = 'Dear {attendee_name},\n\nWe have an important update regarding {event_title}.\n\n[Please add your update details here]\n\nEvent Details:\n- Date: {event_date}\n- Venue: {venue_name}\n\nIf you have any questions, please don\'t hesitate to contact us.\n\nThank you for your understanding.\n\nBest regards,\nThe Event Team';
    } else if (type === 'thankyou') {
        subjectInput.value = 'Thank You for Attending {{ event.title }}!';
        messageInput.value = 'Dear {attendee_name},\n\nThank you for attending {event_title}! We hope you had a wonderful experience.\n\nYour participation made the event a great success. We would love to hear your feedback about the event.\n\nStay tuned for our upcoming events and we hope to see you again soon!\n\nWith gratitude,\nThe Event Team';
    }
}
</script>
{% endblock %}